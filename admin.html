<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>ZUNRDP | ADMIN</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>body { background: #020205; color: white; font-family: sans-serif; }</style>
</head>
<body class="p-10">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-2xl font-black text-yellow-500 mb-10 italic">ADMIN CONTROL PANEL</h1>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-10">
            <div class="bg-gray-900/50 p-6 rounded-2xl border border-white/5">
                <h3 class="text-sm font-bold text-blue-400 mb-4 uppercase">Thêm Thành Viên</h3>
                <div class="space-y-3">
                    <input type="text" id="au" placeholder="Username" class="w-full p-3 bg-black rounded-xl border border-gray-800">
                    <input type="text" id="ap" placeholder="Password" class="w-full p-3 bg-black rounded-xl border border-gray-800">
                    <input type="text" id="at" placeholder="GitHub Token" class="w-full p-3 bg-black rounded-xl border border-gray-800">
                    <input type="text" id="ar" placeholder="User/Repo" class="w-full p-3 bg-black rounded-xl border border-gray-800">
                    <button onclick="save()" class="w-full py-4 bg-blue-600 rounded-xl font-bold uppercase text-xs">Cấp Key Mới</button>
                </div>
            </div>
            <div class="bg-gray-900/50 p-6 rounded-2xl border border-white/5">
                <h3 class="text-sm font-bold text-blue-400 mb-4 uppercase">Danh sách User</h3>
                <div id="ul" class="space-y-3"></div>
            </div>
        </div>
    </div>

    <script>
        const API = "https://zunrdp-default-rtdb.asia-southeast1.firebasedatabase.app";

        async function save() {
            const u = document.getElementById('au').value.toLowerCase().trim();
            const p = document.getElementById('ap').value.trim();
            const t = document.getElementById('at').value.trim();
            const r = document.getElementById('ar').value.trim();
            const key = "ZUN-" + Math.floor(1000 + Math.random() * 9000);
            if(!u || !p || !t || !r) return alert("Thiếu info!");
            await fetch(`${API}/users/${u}.json`, {
                method: 'PATCH',
                body: JSON.stringify({ password:p, token:t, repo:r, key:key, status:'active' })
            });
            alert("Key: " + key); load();
        }

        async function load() {
            const users = await fetch(`${API}/users.json`).then(r => r.json()) || {};
            let h = '';
            for(let n in users) {
                const b = users[n].status === 'banned';
                h += `<div class="p-4 bg-black/50 rounded-xl flex justify-between items-center border border-white/5">
                    <div><p class="font-bold ${b?'text-red-500 line-through':'text-white'}">${n}</p><p class="text-[10px] text-gray-500">${users[n].key}</p></div>
                    <button onclick="ban('${n}', ${b})" class="px-3 py-1 rounded text-[10px] font-bold ${b?'bg-green-600':'bg-red-600'}">${b?'UNBAN':'BAN'}</button>
                </div>`;
            }
            document.getElementById('ul').innerHTML = h;
        }

        async function ban(n, b) {
            await fetch(`${API}/users/${n}.json`, { method:'PATCH', body: JSON.stringify({status: b?'active':'banned'}) });
            load();
        }
        load();
    </script>
</body>
</html>
